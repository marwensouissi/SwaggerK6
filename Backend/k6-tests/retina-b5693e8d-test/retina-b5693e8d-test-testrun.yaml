apiVersion: k6.io/v1alpha1
kind: TestRun
metadata:
  name: retina-b5693e8d-test
  namespace: default
  labels:
    test-name: retina-b5693e8d-test
spec:
  parallelism: 1
  script:
    configMap:
      name: retina-b5693e8d-test
      file: retina-b5693e8d-test.tar
  runner:
    image: ndammakian/xk6-images:1.0
    imagePullPolicy: IfNotPresent
    env:
      - name: K6_WEB_DASHBOARD
        value: "true"
    ports:
      - containerPort: 5665
        name: dashboard
---
apiVersion: v1
kind: Service
metadata:
  name: retina-b5693e8d-test-service
spec:
  type: LoadBalancer
  selector:
    job-name: retina-b5693e8d-test-1
  ports:
    - port: 5665
      targetPort: 5665